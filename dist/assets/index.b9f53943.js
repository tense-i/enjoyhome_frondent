import{_ as I,d as J,u as L,r as i,b as T,o as q,e as m,f as F,i as f,k as l,j as a,w as s,l as c,A as v,F as A,D as x,g as H,B as K,h as b,E as O,J as Q,M as g,ab as W,P as X}from"./index.2854391f.js";import{e as Y}from"./commonData.fd496339.js";const Z={class:"bg-wt contentBox"},$=l("div",{class:"headbox"},"\u4E2A\u4EBA\u4E2D\u5FC3",-1),ee={class:"bodybox"},ue={class:"leftBox"},ae=l("span",null,",",-1),le={class:"rightBox"},te=l("div",{class:"t-form__label file"},"\u5934\u50CF",-1),se=l("span",null,[l("svg",{t:"1674963121719",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2386",width:"128",height:"128"},[l("path",{d:"M544 736a32 32 0 0 1-64 0V288a32 32 0 0 1 64 0z","p-id":"2387"}),l("path",{d:"M800 832V672a32 32 0 0 1 64 0v192a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V672a32 32 0 0 1 64 0v160zM496 271.36l-152.32 166.4a32 32 0 1 1-47.36-43.52l176-192a32 32 0 0 1 47.36 0l176 192a32 32 0 0 1-47.36 43.52z","p-id":"2388"})])],-1),oe={name:"UserIndex"},re=J({...oe,setup(ne){const D=L(),e=i({}),C=i(null),V=i(!0),w=i({size:60,unit:"MB",message:"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC760m\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"}),p=i(!1);T();const o=i([{url:""}]),_=i([{url:"https://yjy-oss-videos.oss-accelerate.aliyuncs.com/grzxhz.jpg"}]),E=i(),y=()=>{o.value=_.value},h=async()=>{const r=await O();e.value=r.data,e.value.sex=Number(e.value.sex),e.value.avatar!==void 0?(o.value[0].avatar=e.value.avatar,o.value[0].url=e.value.avatar):(o.value[0].url=_.value[0].url,e.value.avatar=_.value[0].url)},N=()=>{if(p.value)return!0;C.value.validate().then(async r=>{if(r===!0){p.value=!0;const u={realName:e.value.realName,mobile:e.value.mobile,avatar:o.value[0].url,sex:e.value.sex,id:e.value.id};if(!Q(u.mobile))return g.error("\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165"),p.value=!1,!1;(await W(u)).code===200&&(g.success("\u64CD\u4F5C\u6210\u529F"),D.setUserAvatar(u),h(),setTimeout(()=>{p.value=!1,clearTimeout()},3e3))}})},k=()=>{E.value.triggerUpload()},U=r=>r.size>2*1024*1024?(g.error("\u56FE\u7247\u5927\u5C0F\u8D85\u8FC72M\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),!1):!0,z=(r,u)=>{const d=r.response.data;e.value.avatar=d,o.value[0].response.url=d,o.value[0].url=d},M=r=>{X(r)||(e.value.mobile="")};q(()=>{h()});const P=i({realName:[{required:!0,message:"\u59D3\u540D\u4E3A\u7A7A,\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],avatar:[{required:!0,message:"\u5934\u50CF\u4E3A\u7A7A\uFF0C\u8BF7\u4E0A\u4F20\u5934\u50CF",type:"error",trigger:"change"}]});return(r,u)=>{const d=m("t-input"),n=m("t-form-item"),j=m("t-radio"),S=m("t-radio-group"),R=m("t-upload"),G=m("t-form");return F(),f("div",Z,[$,l("div",ee,[a(G,{ref_key:"form",ref:C,rules:P.value,data:e.value,"label-width":88},{default:s(()=>[l("div",ue,[a(n,{label:"\u59D3\u540D\uFF1A",name:"realName"},{default:s(()=>[a(d,{modelValue:e.value.realName,"onUpdate:modelValue":u[0]||(u[0]=t=>e.value.realName=t),placeholder:"\u8BF7\u8F93\u5165",class:"wt-300",clearable:"","show-limit-number":"",maxlength:10},null,8,["modelValue"])]),_:1}),a(n,{label:"\u90AE\u7BB1\uFF1A",name:"nickname"},{default:s(()=>[c(v(e.value.email),1)]),_:1}),a(n,{label:"\u6240\u5C5E\u90E8\u95E8\uFF1A",name:"description"},{default:s(()=>[c(v(e.value.dept),1)]),_:1}),a(n,{label:"\u6240\u5C5E\u804C\u4F4D\uFF1A",name:"region"},{default:s(()=>[c(v(e.value.post),1)]),_:1}),a(n,{label:"\u89D2\u8272\uFF1A",name:"address"},{default:s(()=>[(F(!0),f(A,null,x(e.value.roleList,(t,B)=>(F(),f("span",{key:B,class:"role"},[c(v(t.roleName),1),ae]))),128))]),_:1}),a(n,{label:"\u624B\u673A\u53F7\uFF1A",name:"mobile"},{default:s(()=>[a(d,{modelValue:e.value.mobile,"onUpdate:modelValue":u[1]||(u[1]=t=>e.value.mobile=t),placeholder:"\u8BF7\u8F93\u5165",class:"wt-300",clearable:"","show-limit-number":"",maxlength:11,onChange:M},null,8,["modelValue"])]),_:1}),a(n,{label:"\u6027\u522B\uFF1A",name:"sex"},{default:s(()=>[a(S,{modelValue:e.value.sex,"onUpdate:modelValue":u[2]||(u[2]=t=>e.value.sex=t)},{default:s(()=>[(F(!0),f(A,null,x(K(Y),(t,B)=>(F(),H(j,{key:B,value:t.id},{default:s(()=>[c(v(t.value),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),l("div",le,[a(n,{name:"avatar"},{default:s(()=>[te,a(R,{ref_key:"uploadRef1",ref:E,modelValue:o.value,"onUpdate:modelValue":u[3]||(u[3]=t=>o.value=t),action:"api/common/upload","is-batch-upload":!0,autoUpload:V.value,"size-limit":w.value,tips:"\u56FE\u7247\u5927\u5C0F\u4E0D\u8D85\u8FC72M,\u4EC5\u652F\u6301\u4E0A\u4F20PNG JPG JPEG\u7C7B\u578B\u56FE\u7247",theme:"image",accept:".jpg,.jpeg,.png","before-upload":U,onRemove:y,onSuccess:z},null,8,["modelValue","autoUpload","size-limit"]),b(" \u5916\u90E8\u4E5F\u53EF\u70B9\u51FB\u89E6\u53D1\u4E0A\u4F20\u529F\u80FD "),l("button",{class:"upbtn",onClick:k},[b(" \u4F7F\u7528svg\u56FE "),se,b(" \u5224\u65AD\u5934\u50CF\u6846\u5185\u662F\u5426\u6709\u5185\u5BB9\uFF0C\u6709\u5185\u5BB9\u663E\u793A\u91CD\u65B0\u4E0A\u4F20\uFF0C\u6CA1\u6709\u5185\u5BB9\u663E\u793A\u4E0A\u4F20\u6587\u4EF6 "),c(" "+v(o.value[0].url!==_.value[0].url?"\u91CD\u65B0\u4E0A\u4F20":"\u4E0A\u4F20\u6587\u4EF6"),1)])]),_:1})])]),_:1},8,["rules","data"]),l("div",{class:"boxBottom fx fx-ct bg-wt"},[l("button",{class:"bt wt-60",theme:"primary",onClick:N}," \u4FDD\u5B58 ")])])])}}});var me=I(re,[["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/user/personal/index.vue"]]);export{me as default};
