import{d as le,r as o,H as ge,e as B,f as i,i as c,j as v,w as n,k as e,h as d,F as W,D as se,g as R,B as y,l as $,A as l,_ as oe,aa as he,c as fe,b as Fe,o as be,n as ee,s as Be,t as ye}from"./index.2854391f.js";import{z as ae,A as De,B as ke}from"./commonData.fd496339.js";import{L as Ee,a as Ce,b as we}from"./constants.c6b472dc.js";import{m as K,n as Q,o as Ae,p as Te}from"./date.f423aacf.js";import{c as Se,f as Ie,h as Ne,i as Le,j as Ve}from"./intelligence.5f29353a.js";import{N as X}from"./index.be6ad7be.js";import{S as xe}from"./switchBartop.a1451b4d.js";import{S as Oe}from"./switchBar.088ec857.js";const je={class:"dialogBox tableDialog lookSelectDialog"},ze={class:"dialogCenter"},Ke=le({__name:"LookData",props:{dialogData:{type:Array,default:()=>[]},dialogVisible:{type:Boolean,default:!1},pagination:{type:Object,default:()=>({})},dataLoading:{type:Boolean,default:!1}},emits:["handleCloseDialog","getCurrent","handleSearch"],setup(f,{emit:C}){const q=f,H=o(),w=o(null),T=o(!1),k=o([]),E=o(0),S=o(0);ge(q,p=>{T.value=p.dialogVisible});const x=()=>{w.value.reset(),E.value=0,S.value=0,k.value=[],C("handleCloseDialog")},O=p=>{C("getCurrent",p)},P=p=>{if(S.value=p,p<3){const g=ae.filter(I=>I.id===p);C("handleSearch",he(g[0].value)),k.value=[]}},s=p=>{C("handleSearch",p)};return(p,g)=>{const I=B("t-option"),F=B("t-select"),J=B("t-date-range-picker"),M=B("t-form-item"),N=B("t-col"),u=B("t-row"),U=B("t-form"),A=B("t-table"),L=B("t-dialog");return i(),c("div",je,[v(L,{visible:T.value,"onUpdate:visible":g[2]||(g[2]=m=>T.value=m),header:"\u67E5\u770B\u6570\u636E","on-close":x,footer:!1,onCloseBtnClick:x},{default:n(()=>[e("div",ze,[d(" \u641C\u7D22 "),v(U,{ref_key:"ruleForm",ref:w,data:f.pagination,"label-width":80},{default:n(()=>[v(u,null,{default:n(()=>[v(N,{span:12},{default:n(()=>[v(u,null,{default:n(()=>[v(N,{span:8},{default:n(()=>[v(M,{label:"\u65F6\u95F4\u8303\u56F4\uFF1A",name:"name"},{default:n(()=>[v(F,{modelValue:E.value,"onUpdate:modelValue":g[0]||(g[0]=m=>E.value=m),filterable:"",placeholder:"\u8BF7\u9009\u62E9",onChange:P},{default:n(()=>[(i(!0),c(W,null,se(y(ae),(m,j)=>(i(),R(I,{key:j,value:m.id,label:m.value,title:""},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),S.value===3?(i(),R(J,{key:0,modelValue:k.value,"onUpdate:modelValue":g[1]||(g[1]=m=>k.value=m),placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],clearable:"",onChange:s},null,8,["modelValue"])):d("v-if",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),d(" end "),d(" table \u6570\u636E "),v(A,{ref_key:"regTable",ref:H,"row-key":"rowKey",data:f.dialogData,columns:y(Ee),pagination:f.pagination.total>5?f.pagination:null,"disable-data-page":f.pagination.total<=5,loading:f.dataLoading,"cell-empty-content":"-",onPageChange:O},{rowIndex:n(({rowIndex:m})=>[$(l(m+1),1)]),time:n(({row:m})=>[e("span",null,l(m.time!==void 0?y(K)(m.time):"--"),1)]),empty:n(()=>[v(X)]),_:1},8,["data","columns","pagination","disable-data-page","loading"]),d(" end ")])]),_:1},8,["visible"])])}}});var He=oe(Ke,[["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/intelligence/equipment/components/LookData.vue"]]);const r=f=>(Be("data-v-23d3c275"),f=f(),ye(),f),Pe={class:"detail-base intelligenc"},Me={ref:"mainHeight",class:"bg-wt"},Ue={class:"info-block"},$e={class:"info-item"},Re=r(()=>e("h1",{class:"label-wt"},"\u8BBE\u5907\u540D\u79F0\uFF1A",-1)),qe={class:"info-item"},Je=r(()=>e("h1",{class:"label-wt"},"\u6240\u5C5E\u4EA7\u54C1\uFF1A",-1)),Ge={class:"info-item"},Qe=r(()=>e("h1",{class:"label-wt"},"DeviceSecret\uFF1A",-1)),We={class:"info-item"},Xe=r(()=>e("h1",{class:"label-wt"},"ProductKey\uFF1A",-1)),Ye={class:"info-item"},Ze=r(()=>e("h1",{class:"label-wt"},"\u8BBE\u5907\u72B6\u6001\uFF1A",-1)),ea={key:0,class:"bt-small"},aa={key:1,class:"bt-small"},ta={key:2,class:"bt-small"},la={key:3,class:"bt-small"},sa={class:"info-item"},oa=r(()=>e("h1",{class:"label-wt"},"\u63A5\u5165\u4F4D\u7F6E\uFF1A",-1)),na={key:0},ua={key:1},ia={key:2},ca={ref:"mainHeight",class:"bg-wt min-steph height mt-24"},da={key:0},va={class:"info-block"},ra={class:"info-item"},_a=r(()=>e("h1",{class:"label-wt"},"\u8BBE\u5907\u540D\u79F0\uFF1A",-1)),ma={class:"info-item"},pa=r(()=>e("h1",null,"\u5907\u6CE8\u540D\u79F0\uFF1A",-1)),ga={class:"info-item"},ha=r(()=>e("h1",{class:"label-wt"},"\u5730\u57DF\uFF1A",-1)),fa={class:"info-item"},Fa=r(()=>e("h1",null,"\u8282\u70B9\u7C7B\u578B\uFF1A",-1)),ba=r(()=>e("div",{class:"info-item"},[e("h1",{class:"label-wt"},"\u8BA4\u8BC1\u65B9\u5F0F\uFF1A"),e("span",null,"\u8BBE\u5907\u5BC6\u94A5")],-1)),Ba={class:"info-item"},ya=r(()=>e("h1",null,"IP\u5730\u5740\uFF1A",-1)),Da={class:"info-item"},ka=r(()=>e("h1",{class:"label-wt"},"\u56FA\u4EF6\u7248\u672C\uFF1A",-1)),Ea={class:"info-item"},Ca=r(()=>e("h1",null,"\u521B\u5EFA\u4EBA\uFF1A",-1)),wa={class:"info-item"},Aa=r(()=>e("h1",{class:"label-wt"},"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1)),Ta={class:"info-item"},Sa=r(()=>e("h1",null,"\u6FC0\u6D3B\u65F6\u95F4\uFF1A",-1)),Ia={key:1},Na={class:"modelBox"},La={class:"modelL"},Va={class:"modelList"},xa=["onClick"],Oa={class:"modelR"},ja=r(()=>e("span",null,"\u8BBE\u5907\u4FE1\u606F",-1)),za={key:0},Ka={key:1},Ha={class:"operateCon"},Pa=["onClick"],Ma={key:0},Ua={key:1},te="index",$a=le({__name:"details",setup(f){const C=fe(),q=Fe(),H=o(""),w=o(""),T=o(0),k=o(0),E=o(0),S=o(!1),x=o([]),O=o([]),P=o(!1),s=o({}),p=o([]),g=o({}),I=o({}),F=o([]),J=o(null),M=o(null),N=o(null),u=o({pageSize:5,pageNum:1,startTime:new Date(Q()).getTime(),endTime:new Date().getTime()}),U=o([]),A=o({pageSize:10,pageNum:1}),L=o(0);be(()=>{C.query.iotId!==void 0&&(H.value=C.query.iotId,w.value=C.query.productKey,m())});const m=async()=>{const t={iotId:H.value,productKey:w.value},_=await Se(t);_.code===200&&(s.value=_.data,u.value.deviceId=s.value.deviceId,u.value.deviceName=s.value.deviceName,s.value.remark&&(F.value=s.value.remark.split(",")),j(s.value))},j=async t=>{const _={productKey:w.value},b=await Ie(_);if(b.code===200){const h=JSON.parse(b.data.thingModelJson);U.value=h.functionBlocks,k.value===0?ne(t,h.properties):ue(t,h.properties)}},ne=async(t,_)=>{g.value={...g.value,deviceName:t.deviceName,productKey:w.value};const b=await Ne(g.value);if(b.code===200){const h=b.data.list.propertyStatusInfo,a=[];E.value===0?(h.forEach(D=>{_.forEach(V=>{if(D.identifier===V.identifier){const G={...D,...V};a.push(G)}})}),p.value=a):p.value=h}},ue=async(t,_)=>{I.value={...I.value,deviceName:t.deviceName,productKey:w.value,startTime:new Date(new Date().toLocaleDateString()).getTime(),endTime:new Date().getTime()};const b=await Le(I.value);if(b.code===200){const h=b.data.list.propertyStatusInfo,a=[];E.value===0?(h&&h.forEach(D=>{_.forEach(V=>{if(D.identifier===V.identifier){const G={...D,...V};a.push(G)}})}),O.value=a):O.value=h}},z=async()=>{const t=await Ve(u.value);if(t.code===200){const _=t.data.records;x.value=_,L.value=Number(t.data.total),u.value.total=Number(t.data.total)}},ie=t=>{T.value=t},ce=t=>{k.value=t,j(s.value)},Y=(t,_)=>{E.value=t,t>0&&_!==void 0?g.value.functionBlockId=_.functionBlockId:delete g.value.functionBlockId,j(s.value)},Z=t=>{A.value.pageNum=t.current,A.value.pageSize=t.pageSize},de=t=>{u.value.functionId=t.identifier,S.value=!0,z()},ve=()=>{S.value=!1,u.value.startTime=new Date(Q()).getTime(),u.value.endTime=new Date().getTime(),z()},re=t=>{M.value=!0,delete u.value.startTime,delete u.value.endTime,u.value.endTime=new Date().getTime(),t==="1"?(u.value.startTime=new Date(Q()).getTime(),N.value=60*60*1e3):t==="24"?(u.value.startTime=new Date(Ae()).getTime(),N.value=24*60*60*1e3):t==="7"?(u.value.startTime=new Date(Te()).getTime(),N.value=7*24*60*60*1e3):(N.value=null,u.value.startTime=new Date(t[0]).getTime(),u.value.endTime=new Date(t[1]).getTime()),z()},_e=()=>{u.value={pageSize:5,pageNum:1},z()},me=t=>{u.value.pageNum=t.current,u.value.pageSize=t.pageSize,z()},pe=()=>{q.go(-1)};return(t,_)=>{const b=B("t-card"),h=B("t-table");return i(),c(W,null,[e("div",Pe,[d(" \u8BBE\u5907\u4FE1\u606F "),e("div",Me,[v(b,{title:"\u8BBE\u5907\u4FE1\u606F"},{default:n(()=>[e("div",Ue,[e("div",$e,[Re,e("span",null,l(s.value.deviceName),1)]),e("div",qe,[Je,e("span",null,l(s.value.productName),1)]),e("div",Ge,[Qe,e("span",null,l(s.value.deviceSecret),1)]),e("div",We,[Xe,e("span",null,l(s.value.productKey),1)]),e("div",Ye,[Ze,e("span",null,[s.value.status==="ONLINE"?(i(),c("span",ea,"\u5728\u7EBF")):s.value.status==="OFFLINE"?(i(),c("span",aa,"\u79BB\u7EBF")):s.value.status==="UNACTIVE"?(i(),c("span",ta,"\u672A\u6FC0\u6D3B")):(i(),c("span",la,"\u5DF2\u7981\u7528"))])]),e("div",sa,[oa,e("span",null,[F.value.length===1?(i(),c("span",na,l(F.value[0]),1)):d("v-if",!0),F.value.length===2?(i(),c("span",ua,l(F.value[0])+"-"+l(F.value[1]),1)):d("v-if",!0),F.value.length===3?(i(),c("span",ia,l(F.value[0])+"-"+l(F.value[1])+"-"+l(F.value[2]),1)):d("v-if",!0)])])])]),_:1})],512),d(" end "),e("div",ca,[v(xe,{ref:"tabBar",data:y(De),onChangeId:ie},null,8,["data"]),d(" \u8BBE\u5907\u8BE6\u60C5 "),T.value===0?(i(),c("div",da,[v(b,{title:"\u8BBE\u5907\u4FE1\u606F"},{default:n(()=>[e("div",va,[e("div",ra,[_a,e("span",null,l(s.value.deviceName),1)]),e("div",ma,[pa,e("span",null,l(s.value.nickname),1)]),e("div",ga,[ha,e("span",null,l(s.value.region),1)]),e("div",fa,[Fa,e("span",null,l(s.value.nodeType===0?"\u76F4\u8FDE\u8BBE\u5907":"\u7F51\u5173"),1)]),ba,e("div",Ba,[ya,e("span",null,l(s.value.ipAddress?s.value.ipAddress:"--"),1)]),e("div",Da,[ka,e("span",null,l(s.value.firmwareVersion?s.value.firmwareVersion:"--"),1)]),e("div",Ea,[Ca,e("span",null,l(s.value.creator?s.value.creator:"--"),1)]),e("div",wa,[Aa,e("span",null,l(s.value.gmtCreate),1)]),e("div",Ta,[Sa,e("span",null,l(s.value.gmtActive?s.value.gmtActive:"--"),1)])])]),_:1})])):d("v-if",!0),d(" end "),d(" \u7269\u6A21\u578B\u6570\u636E "),T.value===1?(i(),c("div",Ia,[e("div",Na,[e("div",La,[v(Oe,{ref:"tabBar",data:y(ke),onChangeId:ce},null,8,["data"]),e("div",Va,[e("ul",null,[e("li",{class:ee(E.value===0?"active":""),onClick:_[0]||(_[0]=a=>Y(0))}," \u9ED8\u8BA4\u6A21\u5757 ",2),(i(!0),c(W,null,se(U.value,(a,D)=>(i(),c("li",{key:D,class:ee(E.value===D+1?"active":""),onClick:V=>Y(D+1,a)},[e("p",null,l(a.functionBlockName),1),e("p",null,"\u6807\u8BC6\u7B26\uFF1A"+l(a.functionBlockId),1)],10,xa))),128))])])]),e("div",Oa,[k.value===0?(i(),R(h,{key:0,data:p.value,columns:y(Ce),"row-key":te,"vertical-align":"middle",hover:!0,pagination:A.value.total>10?A.value:null,"disable-data-page":L.value<=10,loading:P.value,"table-layout":"fixed","table-content-width":"100%",onPageChange:Z},{rowIndex:n(({rowIndex:a})=>[$(l(a+1),1)]),information:n(({row:a})=>[ja]),value:n(({row:a})=>[a.name==="\u79BB\u5E8A\u65F6\u95F4"?(i(),c("span",za,l(y(K)(a.value)),1)):(i(),c("span",Ka,l(a.value)+l(a.value?a.unit:"--"),1))]),time:n(({row:a})=>[e("span",null,l(a.time!==void 0?y(K)(a.time):"--"),1)]),op:n(({row:a})=>[e("div",Ha,[e("a",{class:"font-bt",onClick:D=>de(a)},"\u67E5\u770B\u6570\u636E",8,Pa)])]),empty:n(()=>[v(X)]),_:1},8,["data","columns","pagination","disable-data-page","loading"])):d("v-if",!0),k.value===1?(i(),R(h,{key:1,data:O.value,columns:y(we),"row-key":te,"vertical-align":"middle",hover:!0,pagination:A.value.total>10?A.value:null,"disable-data-page":L.value<=10,loading:P.value,"table-layout":"fixed","table-content-width":"100%",onPageChange:Z},{rowIndex:n(({rowIndex:a})=>[$(l(a+1),1)]),value:n(({row:a})=>[a.name==="\u79BB\u5E8A\u65F6\u95F4"?(i(),c("span",Ma,l(y(K)(a.value)),1)):(i(),c("span",Ua,l(a.value)+l(a.value?a.unit:"--"),1))]),time:n(({row:a})=>[e("span",null,l(a.time!==void 0?y(K)(a.time):"--"),1)]),type:n(({row:a})=>[$(l(a.type===1?"\u4FE1\u606F":"\u6545\u969C"),1)]),empty:n(()=>[v(X)]),_:1},8,["data","columns","pagination","disable-data-page","loading"])):d("v-if",!0)])])])):d("v-if",!0),d(" end ")],512),v(He,{dialogVisible:S.value,"dialog-data":x.value,pagination:u.value,nextValid:J.value,preValid:M.value,total:L.value,onHandleSearch:re,onHandleReset:_e,onHandleCloseDialog:ve,onGetCurrent:me},null,8,["dialogVisible","dialog-data","pagination","nextValid","preValid","total"])]),e("div",{class:"boxBottom fx fx-ct bg-wt"},[e("button",{class:"bt-grey wt-60",onClick:pe},"\u8FD4\u56DE")])],64)}}});var Za=oe($a,[["__scopeId","data-v-23d3c275"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/intelligence/equipment/details.vue"]]);export{Za as default};
