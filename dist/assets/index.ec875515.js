import{d as U,r as e,o as X,M as T,H as P,e as v,f as j,i as R,j as a,w as u,k as p,A as L,h as b,l as J,F as ae,D as le,g as oe,_ as K,X as ne,s as ue,t as se,a7 as de,n as G,B as Q,c as ce,T as re}from"./index.2854391f.js";import{c as ie,g as pe,u as _e,v as ve,w as Y,x as me,y as fe}from"./permission.e33085b3.js";import{P as he}from"./ProdDisabled.360adeb3.js";import{D as De}from"./disable.c6af54f3.js";import{N as be}from"./index.be6ad7be.js";import{S as ge}from"./index.4df8b0b7.js";const W=F=>(ue("data-v-493d6187"),F=F(),se(),F),Fe={class:"dialog-form"},Ee={class:"dialog-header"},Ce={class:"dialog-title"},ye=W(()=>p("span",{class:"information"},null,-1)),ke=W(()=>p("span",null,"\u53D6\u6D88",-1)),xe=[ke],Ne=W(()=>p("button",{theme:"primary",type:"submit",class:"bt btn-submit"},[p("span",null,"\u786E\u5B9A")],-1)),Se=U({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},title:{type:String,default:"\u65B0\u5EFA\u90E8\u95E8"}},emits:["handleClose","fetchData"],setup(F,{expose:o,emit:r}){const m=F,C=e("empty"),h=e(!1),E=e(0),t=e({deptName:"",leaderId:"",parentDeptNo:"",dataState:"",sortNo:0,remark:""}),_=e(""),y=e(),k=e([]),x=e([]);X(()=>{S(),d()});const g=c=>{ne(c)},N=()=>{const c=Number(t.value.sortNo);c<=0?t.value.sortNo=0:c>=9999&&(t.value.sortNo=9999)},S=async()=>{ie({level:3}).then(c=>{c.code===200&&(k.value=c.data.items,console.log(k.value,"-------------"))}).catch(c=>{T.error(`\u90E8\u95E8\u6570\u636E\u83B7\u53D6\u5931\u8D25! ${c.message}`)})},d=async()=>{pe().then(c=>{c.code===200&&(x.value=c.data)})},B=c=>{c.validateResult===!0&&(m.title==="\u65B0\u589E\u90E8\u95E8"?w(t.value):A(t.value))},w=async c=>{_e(c).then(n=>{n.code===200&&(T.success("\u90E8\u95E8\u6DFB\u52A0\u6210\u529F"),S(),r("fetchData"),i())})},A=c=>{ve(c).then(n=>{n.code===200&&(T.success("\u90E8\u95E8\u4FEE\u6539\u6210\u529F"),S(),r("fetchData"),i())}).catch(n=>{T.error(`\u8BF7\u6C42\u51FA\u9519\u4E86\uFF01 ${n.message}`)})},i=()=>{y.value.reset(),t.value.sortNo=0,t.value.leaderId="",h.value=!1,r("handleClose")};P(()=>m.visible,c=>{if(_.value=m.title,h.value=m.visible,console.log(m,"props"),c){const{data:n}=m;m.title==="\u65B0\u589E\u90E8\u95E8"?t.value.parentDeptNo=n.parentDeptNo:t.value=JSON.parse(JSON.stringify(n)),t.value.parentDeptNo=n.parentDeptNo!==void 0?String(n.parentDeptNo):"",console.log(t.value,"val")}}),o({fetchData:S});const $={dataState:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8\u72B6\u6001",type:"error",trigger:"blur"}],parentDeptNo:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",type:"error",trigger:"change"}],deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",type:"error",trigger:"blur"}],sortNo:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u6392\u5E8F",type:"error",trigger:"blur"}]};return(c,n)=>{const I=v("t-cascader"),l=v("t-form-item"),V=v("t-input"),O=v("t-input-number"),f=v("t-radio"),H=v("t-radio-group"),q=v("t-option"),s=v("t-select"),z=v("t-textarea"),M=v("t-form"),ee=v("t-dialog");return j(),R("div",Fe,[a(ee,{visible:h.value,"onUpdate:visible":n[6]||(n[6]=D=>h.value=D),footer:!1,"on-close":i},{header:u(()=>[p("div",Ee,[p("span",Ce,L(_.value),1),ye])]),body:u(()=>[b(" \u8868\u5355\u5185\u5BB9 "),a(M,{ref_key:"form",ref:y,data:t.value,rules:$,"label-width":95,"on-cancel":"onClickCloseBtn","reset-type":C.value,onSubmit:B},{default:u(()=>[a(l,{label:"\u4E0A\u7EA7\u90E8\u95E8\uFF1A",name:"parentDeptNo"},{default:u(()=>[a(I,{modelValue:t.value.parentDeptNo,"onUpdate:modelValue":n[0]||(n[0]=D=>t.value.parentDeptNo=D),keys:{label:"label",value:"id",children:"children"},options:k.value,"check-strictly":"",filterable:""},null,8,["modelValue","options"])]),_:1}),a(l,{label:"\u90E8\u95E8\u540D\u79F0\uFF1A",name:"deptName"},{default:u(()=>[a(V,{modelValue:t.value.deptName,"onUpdate:modelValue":n[1]||(n[1]=D=>t.value.deptName=D),placeholder:"\u8BF7\u8F93\u5165 ",clearable:"",maxlength:10,"show-limit-number":""},null,8,["modelValue"])]),_:1}),a(l,{label:"\u6392\u5E8F\uFF1A",name:"sortNo"},{default:u(()=>[a(O,{modelValue:t.value.sortNo,"onUpdate:modelValue":n[2]||(n[2]=D=>t.value.sortNo=D),min:E.value,onBlur:N,onOnkeyup:g,onChange:N},null,8,["modelValue","min"])]),_:1}),a(l,{label:"\u90E8\u95E8\u72B6\u6001\uFF1A",name:"dataState"},{default:u(()=>[a(H,{modelValue:t.value.dataState,"onUpdate:modelValue":n[3]||(n[3]=D=>t.value.dataState=D),"default-value":t.value.dataState},{default:u(()=>[a(f,{value:"0"},{default:u(()=>[J("\u542F\u7528")]),_:1}),a(f,{value:"1"},{default:u(()=>[J("\u7981\u7528")]),_:1})]),_:1},8,["modelValue","default-value"])]),_:1}),a(l,{label:"\u90E8\u95E8\u8D1F\u8D23\u4EBA\uFF1A"},{default:u(()=>[a(s,{modelValue:t.value.leaderId,"onUpdate:modelValue":n[4]||(n[4]=D=>t.value.leaderId=D),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:u(()=>[(j(!0),R(ae,null,le(x.value,(D,te)=>(j(),oe(q,{key:te,value:D.id,label:D.realName,title:""},{default:u(()=>[J(L(D.realName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(l,{label:"\u90E8\u95E8\u8BF4\u660E\uFF1A",name:"remark"},{default:u(()=>[a(z,{modelValue:t.value.remark,"onUpdate:modelValue":n[5]||(n[5]=D=>t.value.remark=D),placeholder:"\u8BF7\u8F93\u5165",maxlength:300},null,8,["modelValue"])]),_:1}),a(l,{style:{float:"right"},class:"dialogBtnBox"},{default:u(()=>[p("div",{class:"bt bt-grey btn-submit",onClick:i},xe),Ne]),_:1})]),_:1},8,["data","reset-type"]),b(` <t-enhanced-table\r
          ref="tableRef"\r
          table-layout="auto"\r
          row-key="id"\r
          :tree="{ childrenKey: 'children' }"\r
          :data="options"\r
          :columns="TEST_COLUMNS"\r
          class="tableRef"\r
        ></t-enhanced-table> `),b(" end ")]),_:1},8,["visible"])])}}});var Be=K(Se,[["__scopeId","data-v-493d6187"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/dept/components/DialogForm.vue"]]);const Z=[{title:"\u90E8\u95E8\u540D\u79F0",align:"left",colKey:"deptName",minWidth:"157px"},{title:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",ellipsis:!0,colKey:"leaderName"},{title:"\u6392\u5E8F",ellipsis:!0,colKey:"sortNo"},{title:"\u521B\u5EFA\u65E5\u671F",ellipsis:!0,colKey:"createDay",width:"15vw",sortType:"all"},{title:"\u90E8\u95E8\u72B6\u6001",width:"15vw",ellipsis:!0,colKey:"dataState",cell:(F,{row:o})=>{const r={0:{label:"\u542F\u7528"},1:{label:"\u7981\u7528"}};return F("span",{class:`status-dot status-dot-${o.dataState==="0"?"1":"0"}`},r[o.dataState].label)}},{title:"\u90E8\u95E8\u8BF4\u660E",colKey:"remark",width:100,cell:(F,{row:o})=>F("p",{class:"ellipsis",title:o.remark},o.remark?o.remark:"--")},{align:"left",fixed:"right",width:210,minWidth:"240px",colKey:"op",title:"\u64CD\u4F5C"}];const we={class:"innerTable"},$e={class:"updateTime"},Ae=["onClick"],Ve=["onClick"],Te=["onClick"],He=["onClick"],je=U({__name:"Table",props:{rowData:{type:Object,default:()=>({})}},emits:["fetchData","handleSetupContract","handleBulid","handleClickDelete","handleClickDisable"],setup(F,{emit:o}){const r=F,m=e(!1),C=e([]),h=e(!1),E=e([]),t=async d=>{h.value=!0;const B={parentDeptNo:d,pageNum:1,pageSize:10};console.log(d,"deptId"),Y(B).then(w=>{w.code===200&&(E.value=w.data)}).catch(w=>{h.value=!1})},_=d=>{C.value=d};de(()=>{r.rowData&&(console.log(r.rowData,"props.rowData"),t(r.rowData.deptNo))});const y=(d,B)=>{d.tg?o("handleSetupContract",{...d}):o("handleSetupContract",{data:d,tg:B})},k=d=>{o("handleClickDisable",d)},x=e(-1),g=d=>{o("handleClickDelete",d),x.value=d.rowIndex},N=()=>{o("handleBulid")},S=()=>{console.log("table"),o("fetchData")};return(d,B)=>{const w=v("Table",!0),A=v("t-table");return j(),R("div",we,[a(A,{"row-key":"deptNo",data:E.value,columns:Q(Z),"show-header":!1,"expanded-row-keys":C.value,expandIcon:!!E.value.length,"expand-on-row-click":m.value,onExpandChange:_},{updateTime:u(({row:i})=>[p("div",$e,[p("span",null,L(i.updateTime||"2023-3-23 3:33:33"),1)])]),op:u(({row:i})=>[p("a",{class:"btn-dl line btn-split-right",onClick:$=>g(i)},"\u5220\u9664",8,Ae),p("a",{class:G(`${i.dataState==="0"?"btn-dl":""} line btn-split-right`),onClick:$=>k(i)},L(i.dataState==="0"?"\u7981\u7528":"\u542F\u7528"),11,Ve),p("a",{class:"font-bt line",onClick:$=>y(i,"edit")},"\u7F16\u8F91",8,Te),p("a",{class:"font-bt btn-split-left",onClick:$=>y(i,"add")},"\u65B0\u589E\u90E8\u95E8",8,He)]),expandedRow:u(({row:i})=>[a(w,{rowData:i,onHandleSetupContract:y,onHandleBulid:N,onHandleClickDelete:g,onHandleClickDisable:k,onFetchData:S},null,8,["rowData"])]),_:1},8,["data","columns","expanded-row-keys","expandIcon","expand-on-row-click"])])}}});var Ie=K(je,[["__scopeId","data-v-393b5ec3"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/dept/components/Table.vue"]]);const Re={class:"deptAdmin baseList"},Le={class:"tableBoxs"},Oe={class:"newBox"},Ue={class:"updateTime"},Ke=["onClick"],ze=["onClick"],Me=["onClick"],qe=["onClick"],Je=U({__name:"TableList",props:{listData:{type:Object,default:()=>({})},pagination:{type:Object,default:()=>({})}},emits:["fetchData","handleSetupContract","handleBulid","handleClickDelete","handleClickDisable"],setup(F,{emit:o}){const r=F,m=e(!0),C=e(!1),h=e([]),E=l=>{console.log(l,"value"),h.value=l};P(r,()=>{_.value=r.listData,y.value=r.pagination,x.value=!1});const t=e({sortBy:"serviceCallNumber"}),_=e([]),y=e({defaultPageSize:10,total:0,defaultCurrent:1}),k=e({status:""}),x=e(!0),g=l=>{t.value=l,N(l)},N=l=>{o("fetchData",l)},S=l=>{d(l)},d=l=>{o("fetchData",l)},B=e([1,2]),w=l=>{B.value=l},A=(l,V)=>{l.tg?o("handleSetupContract",{...l}):o("handleSetupContract",{data:l,tg:V})},i=e(-1),$=l=>{o("handleClickDelete",l),i.value=l.rowIndex},c=l=>{o("handleClickDisable",l)},n=()=>{o("handleBulid")},I=()=>{console.log("tableList"),o("fetchData")};return(l,V)=>{const O=v("t-table");return j(),R("div",Re,[p("div",Le,[p("div",Oe,[p("button",{class:"bt newBoxbutton",onClick:V[0]||(V[0]=f=>n())},"\u65B0\u589E\u90E8\u95E8")]),a(O,{data:_.value,columns:Q(Z),"row-key":"deptNo","vertical-align":"middle",hover:!0,"expanded-row-keys":h.value,"expand-on-row-click":C.value,"expand-icon":m.value,"selected-row-keys":B.value,loading:x.value,sort:t.value,"filter-value":k.value,"hide-sort-tips":!0,"show-sort-column-bg-color":!0,"table-layout":"auto",onFilterChange:S,onSortChange:g,onSelectChange:w,onExpandChange:E},{updateTime:u(({row:f})=>[p("div",Ue,[p("span",null,L(f.updateTime||"2023-3-23 3:33:33"),1)])]),op:u(({row:f})=>[p("a",{class:"btn-dl line btn-split-right pdo",onClick:H=>$(f)},"\u5220\u9664",8,Ke),p("a",{class:G(`${f.dataState==="0"?"btn-dl":""} line btn-split-right`),onClick:H=>c(f)},L(f.dataState==="0"?"\u7981\u7528":"\u542F\u7528"),11,ze),p("a",{class:"font-bt line",onClick:H=>A(f,"edit")},"\u7F16\u8F91",8,Me),p("a",{class:"font-bt btn-split-left",onClick:H=>A(f,"add")},"\u65B0\u589E\u90E8\u95E8",8,qe)]),expandedRow:u(({row:f})=>[a(Ie,{rowData:f,onHandleSetupContract:A,onHandleBulid:n,onHandleClickDelete:$,onHandleClickDisable:c,onFetchData:I},null,8,["rowData"])]),empty:u(()=>[a(be)]),_:1},8,["data","columns","expanded-row-keys","expand-on-row-click","expand-icon","selected-row-keys","loading","sort","filter-value"])])])}}});var Pe=K(Je,[["__scopeId","data-v-556a31fe"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/dept/components/TableList.vue"]]);const Qe={class:"formBox"},We=U({__name:"SearchForm",emits:["handleSearch","handleReset"],setup(F,{emit:o}){const r=e({deptName:"",dataState:""}),m={deptName:"",dataState:""},C=(t,_)=>{_.e.preventDefault()},h=()=>{r.value={...m},o("handleReset",r.value)},E=()=>{o("handleSearch",r.value)};return(t,_)=>{const y=v("t-input"),k=v("t-form-item"),x=v("t-col"),g=v("t-select"),N=v("t-row"),S=v("t-form");return j(),R("div",Qe,[a(S,{ref:"form",data:r.value,"label-width":70},{default:u(()=>[a(N,null,{default:u(()=>[a(x,null,{default:u(()=>[a(k,{label:"\u90E8\u95E8\u540D\u79F0\uFF1A",name:"name"},{default:u(()=>[a(y,{modelValue:r.value.deptName,"onUpdate:modelValue":_[0]||(_[0]=d=>r.value.deptName=d),class:"form-item-content",type:"search",placeholder:"\u8BF7\u8F93\u5165",clearable:"",maxlength:10,onEnter:C},null,8,["modelValue"])]),_:1})]),_:1}),a(x,null,{default:u(()=>[a(k,{label:"\u90E8\u95E8\u72B6\u6001\uFF1A",name:"status"},{default:u(()=>[a(g,{modelValue:r.value.dataState,"onUpdate:modelValue":_[1]||(_[1]=d=>r.value.dataState=d),class:"form-item-content",options:Q(ge),placeholder:"\u8BF7\u9009\u62E9",clearable:""},null,8,["modelValue","options"])]),_:1})]),_:1}),b(" \u6309\u94AE\u533A\u57DF "),a(x,{class:"searchBtn"},{default:u(()=>[p("button",{class:"bt-grey wt-60",onClick:_[2]||(_[2]=d=>h())},"\u91CD\u7F6E"),p("button",{class:"bt wt-60",onClick:_[3]||(_[3]=d=>E())},"\u641C\u7D22")]),_:1})]),_:1})]),_:1},8,["data"])])}}});var Xe=K(We,[["__scopeId","data-v-695f69e7"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/dept/components/SearchForm.vue"]]);const Ge={class:"deptAdmin min-h bg-wt"},Ye=U({__name:"index",setup(F){const o=e(!1),r=e({}),m=e(!1),C=e({}),h=e("\u65B0\u589E\u90E8\u95E8"),E=e(!1),t=e(!1),_=e("\u90E8\u95E8"),y=e(!1),k=ce(),x=e(""),g=e({}),N=e(null),S=e({pageSize:10,pageNum:1}),d={deptName:"",dataStatus:void 0};P(()=>k.path,s=>{x.value=s});const B=e({...d});X(()=>{i({parentDeptNo:"100001000000000",deptName:"",dataStatus:""})});const w=s=>{i(s)},A=s=>{i(s)},i=async s=>{const z={...s,parentDeptNo:"100001000000000"};m.value=!0,Y(z).then(M=>{M.code===200&&(r.value=M.data)}).catch(()=>{m.value=!1})},$=s=>{g.value=s,t.value=!0},c=()=>{t.value=!1,n()},n=async()=>{console.log(g.value,"currrentData.value"),me({deptNo:g.value.deptNo,parentDeptNo:g.value.parentDeptNo,dataState:g.value.dataState==="0"?"1":"0"}).then(s=>{console.log(s,"err"),s.code===200&&(T.success(`${g.value.dataState==="0"?"\u7981\u7528":"\u542F\u7528"}\u6210\u529F`),i(),N.value.fetchData())}).catch(s=>{console.log(s,"err"),T.error(s.msg||"\u8BF7\u6C42\u51FA\u9519\u4E86\uFF01 \u64CD\u4F5C\u5931\u8D25")})},I=e(NaN),l=s=>{s.dataState==="0"?T.error("\u542F\u7528\u72B6\u6001\u4E0B\u4E0D\u53EF\u5220\u9664"):(I.value=s.deptNo,E.value=!0)},V=()=>{E.value=!1,O()},O=async()=>{m.value=!0,fe(I.value).then(s=>{s.code===200&&(T.success("\u5220\u9664\u6210\u529F"),m.value=!1,i(),N.value.fetchData())}).catch(()=>{m.value=!1})},f=()=>{o.value=!1,E.value=!1,t.value=!1,y.value=!1},H=()=>{h.value="\u65B0\u589E\u90E8\u95E8",C.value={parentDeptNo:""},o.value=!0},q=s=>{s.tg==="add"?(h.value="\u65B0\u589E\u90E8\u95E8",C.value={parentDeptNo:s.data.deptNo}):(h.value="\u7F16\u8F91\u90E8\u95E8",C.value=JSON.parse(JSON.stringify(s.data))),o.value=!0};return(s,z)=>(j(),R("div",Ge,[b(" \u7B5B\u9009\u533A\u57DF "),a(Xe,{onHandleSearch:w,onHandleReset:A}),b(" end "),b(" \u8868\u683C "),a(Pe,{"list-data":r.value,pagination:S.value,onHandleSetupContract:q,onHandleBulid:H,onHandleClickDelete:l,onHandleClickDisable:$,onFetchData:i},null,8,["list-data","pagination"]),b(" end "),b(" \u65B0\u589E\uFF0C\u7F16\u8F91\u5F39\u7A97 "),a(Be,{ref_key:"dialogForm",ref:N,visible:o.value,title:h.value,data:C.value,"form-data":B.value,onHandleClose:f,onFetchData:i},null,8,["visible","title","data","form-data"]),b(" end "),b(" \u751F\u4EA7\u73AF\u5883\u7981\u7528\u64CD\u4F5C\u5F39\u7A97 "),a(he,{"confirm-visible":y.value,onHandleClose:f},null,8,["confirm-visible"]),b(" end "),b(" \u5220\u9664\u5F39\u5C42 "),a(re,{visible:E.value,"delete-text":_.value,onHandleDelete:V,onHandleClose:f},null,8,["visible","delete-text"]),b(" end "),b(" end "),b(" \u7981\u7528\u542F\u7528\u5F39\u5C42 "),a(De,{visible:t.value,dataState:g.value.dataState,onHandleClick:c,onHandleClose:f},null,8,["visible","dataState"]),b(" end ")]))}});var nt=K(Ye,[["__scopeId","data-v-381e04f4"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/dept/index.vue"]]);export{nt as default};
