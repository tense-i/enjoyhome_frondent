import{d as W,r as u,H as q,e as C,f as E,i as H,j as l,w as r,k as e,A as U,h as p,l as I,_ as X,M as N,s as ue,t as le,o as ce,V as te,n as z,F as G,D as ae,a2 as w,a6 as j,Z as he,g as de,T as me}from"./index.2854391f.js";import{i as De,j as re,k as ge,l as be,m as Ce,c as ye,n as ne}from"./permission.e33085b3.js";import{D as ke}from"./disable.c6af54f3.js";import{N as Fe}from"./index.be6ad7be.js";const oe=f=>(ue("data-v-5e6ccf10"),f=f(),le(),f),Ne={class:"dialog-form"},xe={class:"dialog-header"},Be={class:"dialog-title"},Se=oe(()=>e("span",{class:"information"},null,-1)),$e=oe(()=>e("span",null,"\u53D6\u6D88",-1)),Ee=[$e],Re=oe(()=>e("button",{theme:"primary",type:"submit",class:"bt btn-submit"},[e("span",null,"\u786E\u5B9A")],-1)),Ae=W({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},title:{type:String,default:"\u6DFB\u52A0\u89D2\u8272"}},emits:["handleClose","fetchData"],setup(f,{emit:B}){const s=f,A=u("empty"),m=u(!1),i=u({roleName:"",dataState:""}),y=u(""),S=u(),V=b=>{b.validateResult===!0&&(s.title==="\u65B0\u589E\u89D2\u8272"?$(i.value):g(i.value))},$=async b=>{De(b).then(n=>{n.code===200&&(N.success("\u89D2\u8272\u6DFB\u52A0\u6210\u529F"),B("fetchData"),o())})},g=b=>{re(b).then(n=>{o(),n.code===200?(N.success("\u89D2\u8272\u4FEE\u6539\u6210\u529F"),B("fetchData")):N.error(`${n.msg}`)}).catch(n=>{N.error(`\u8BF7\u6C42\u51FA\u9519\u4E86\uFF01 ${n.message}`)})},o=()=>{S.value.reset(),m.value=!1,B("handleClose")};q(()=>s.visible,()=>{m.value=s.visible,y.value=s.title}),q(()=>s.data,b=>{i.value=JSON.parse(JSON.stringify(b)),console.log(i.value,"formData.value")});const D={roleName:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",type:"error",trigger:"blur"}],dataState:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272\u72B6\u6001",type:"error",trigger:"change"}]};return(b,n)=>{const v=C("t-input"),L=C("t-form-item"),a=C("t-radio"),_=C("t-radio-group"),M=C("t-form"),J=C("t-dialog");return E(),H("div",Ne,[l(J,{visible:m.value,"onUpdate:visible":n[2]||(n[2]=t=>m.value=t),footer:!1,"on-close":o},{header:r(()=>[e("div",xe,[e("span",Be,U(y.value),1),Se])]),body:r(()=>[p(" \u8868\u5355\u5185\u5BB9 "),l(M,{ref_key:"form",ref:S,data:i.value,rules:D,"label-width":80,"label-align":"left","on-cancel":"onClickCloseBtn","reset-type":A.value,onSubmit:V},{default:r(()=>[l(L,{label:"\u89D2\u8272\u540D\u79F0: ",name:"roleName"},{default:r(()=>[l(v,{modelValue:i.value.roleName,"onUpdate:modelValue":n[0]||(n[0]=t=>i.value.roleName=t),maxlength:10,"show-limit-number":"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),l(L,{label:"\u89D2\u8272\u72B6\u6001:",name:"dataState"},{default:r(()=>[l(_,{modelValue:i.value.dataState,"onUpdate:modelValue":n[1]||(n[1]=t=>i.value.dataState=t),"default-value":i.value.dataState},{default:r(()=>[l(a,{value:"0"},{default:r(()=>[I("\u542F\u7528")]),_:1}),l(a,{value:"1"},{default:r(()=>[I("\u7981\u7528")]),_:1})]),_:1},8,["modelValue","default-value"])]),_:1}),p(` <t-form-item label="\u89D2\u8272\u8BF4\u660E:" name="remark"\r
            ><t-textarea\r
              v-model="formData.remark"\r
              placeholder="\u8BF7\u8F93\u5165"\r
              :maxlength="300"\r
            >\r
            </t-textarea>\r
          </t-form-item> `),l(L,{style:{float:"right"},class:"footer-btn"},{default:r(()=>[e("div",{class:"bt bt-grey btn-submit",onClick:o},Ee),Re]),_:1})]),_:1},8,["data","reset-type"]),p(" end ")]),_:1},8,["visible"])])}}});var Ve=X(Ae,[["__scopeId","data-v-5e6ccf10"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/role/components/DialogForm.vue"]]);const K=f=>(ue("data-v-5f441180"),f=f(),le(),f),Le={class:"roleCont pd-box"},Te={class:"head fx fx-sb"},Ie={class:"searchBox"},He={class:"roleTable fx-fd-col"},Me=K(()=>e("div",{class:"fx-1"},"\u89D2\u8272\u540D\u79F0",-1)),we=K(()=>e("div",{class:"fx-1"},"\u89D2\u8272\u72B6\u6001",-1)),je=K(()=>e("div",{class:"fx-1"},"\u64CD\u4F5C",-1)),Pe=[Me,we,je],ze={class:"tabList pt-rt fx-1"},Ue=["onClick"],Oe=["title"],qe={class:"fx-1"},Je={class:"fx-1"},Ke=["onClick"],Qe=["onClick"],Ze=["onClick"],Ge=K(()=>e("span",{class:"topTag"},null,-1)),We=K(()=>e("span",{class:"botTag"},null,-1)),Xe=[Ge,We],Ye={class:"pageCont"},et=W({__name:"RoleList",props:{defaultIndex:{type:Number,default:()=>0}},emits:["clickRow"],setup(f,{expose:B,emit:s}){const A=f;ce(()=>{D()});const m=u(!1),i=u(),y=u(0),S=u(!1),V=u("\u89D2\u8272"),$=u({}),g=te({pageNum:1,pageSize:10,roleName:""}),o=u(!1),D=async()=>{S.value=!0,ge(g).then(d=>{d.code===200?(i.value=d.data.records,y.value=Number(d.data.total),o.value=y.value!==0,s("clickRow",i.value[c.value]),y.value<c.value+1&&O(i.value[0].id,0)):N.error(d.msg)}).catch(()=>{S.value=!1})},b=d=>{$.value=d,m.value=!0},n=()=>{m.value=!1,v()},v=async()=>{re({...$.value,dataState:$.value.dataState==="0"?"1":"0"}).then(d=>{d.code===200&&(N.success(`${$.value.dataState==="0"?"\u7981\u7528":"\u542F\u7528"}\u6210\u529F`),D())})},L=()=>{g.pageNum=1,c.value=0,D()},a=u(NaN),_=u(),M=(d,P)=>{d.dataState==="0"?N.error("\u542F\u7528\u72B6\u6001\u4E0B\u4E0D\u53EF\u5220\u9664"):(a.value=d.id,_.value=P,Q.value=!0)},J=()=>{Q.value=!1,t()},t=async()=>{S.value=!0,be({roleIds:a.value}).then(d=>{d.code===200?(N.success("\u5220\u9664\u6210\u529F"),S.value=!1,D(),c.value===_.value&&(c.value=0)):N.error(d.msg)}).catch(()=>{S.value=!1})},h=u({}),k=u({...g}),c=u(0),O=(d,P)=>{c.value!==P&&(c.value=P,s("clickRow",d))},F=u("\u65B0\u589E\u89D2\u8272"),T=u(!1),R=()=>{F.value="\u65B0\u589E\u89D2\u8272",T.value=!0},ie=d=>{d&&(F.value="\u7F16\u8F91\u89D2\u8272",T.value=!0,h.value=d)},Q=u(!1),Y=()=>{T.value=!1,Q.value=!1,m.value=!1,h.value={}},ve=d=>{g.pageNum=d,c.value=0,D()};return q(()=>A.defaultIndex,d=>{c.value=d}),B({fetchData:D}),(d,P)=>{const _e=C("t-icon"),pe=C("t-input"),fe=C("t-pagination");return E(),H(G,null,[e("div",Le,[e("div",Te,[e("div",Ie,[l(pe,{modelValue:g.roleName,"onUpdate:modelValue":P[0]||(P[0]=x=>g.roleName=x),placeholder:"\u8BF7\u8F93\u5165",clearable:"",onEnter:L},{suffixIcon:r(()=>[l(_e,{name:"search",class:"pt",onClick:L})]),_:1},8,["modelValue"])]),e("div",{class:"bt",onClick:R},"\u65B0\u589E\u89D2\u8272")]),p(" \u89D2\u8272\u8868\u683C - start - "),e("div",He,[e("div",{class:z(["tabHead fx",{"bd-non":c.value===0}])},Pe,2),e("div",ze,[(E(!0),H(G,null,ae(i.value,(x,Z)=>(E(),H("div",{key:x.id,class:z(["fx pt-rt z-1 pt",{"bd-non":c.value===Z||c.value-1===Z}]),onClick:ee=>O(x,Z)},[e("p",{class:"fx-1",title:x.roleName},U(x.roleName),9,Oe),e("div",qe,[e("span",{class:z(`status-dot status-dot-${x.dataState==="0"?"1":"0"}`)},U(x.dataState==="0"?"\u542F\u7528":"\u7981\u7528"),3)]),e("div",Je,[e("span",{class:"font-del btn-split-right",onClick:ee=>M(x,Z)},"\u5220\u9664",8,Ke),e("a",{class:z(`${x.dataState==="0"?"btn-dl":""} line btn-split-right`),onClick:ee=>b(x)},U(x.dataState==="0"?"\u7981\u7528":"\u542F\u7528"),11,Qe),e("span",{class:"font-bt",onClick:ee=>ie(x)},"\u7F16\u8F91",8,Ze)])],10,Ue))),128)),w(e("div",{class:"activeRow",style:he({top:`${c.value*51}px`})},Xe,4),[[j,o.value]]),w(l(Fe,null,null,512),[[j,!o.value]])]),e("div",Ye,[y.value>10?(E(),de(fe,{key:0,total:y.value,showPageSize:!1,showPreviousAndNextBtn:"",totalContent:!1,onCurrentChange:ve},null,8,["total"])):p("v-if",!0)])]),p(" \u89D2\u8272\u8868\u683C - end - ")]),p(" \u65B0\u589E\uFF0C\u7F16\u8F91\u5F39\u7A97 "),l(Ve,{visible:T.value,title:F.value,data:h.value,"form-data":k.value,onHandleClose:Y,onFetchData:D},null,8,["visible","title","data","form-data"]),p(" end "),p(" \u5220\u9664\u5F39\u5C42 "),l(me,{visible:Q.value,"delete-text":V.value,onHandleDelete:J,onHandleClose:Y},null,8,["visible","delete-text"]),p(" end "),p(" \u7981\u7528\u542F\u7528\u5F39\u5C42 "),l(ke,{visible:m.value,dataState:$.value.dataState,onHandleClick:n,onHandleClose:Y},null,8,["visible","dataState"])],64)}}});var tt=X(et,[["__scopeId","data-v-5f441180"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/role/components/RoleList.vue"]]);const at={class:"menuCont"},ut={class:"treeRow fx"},lt=["onClick"],ot=["onClick"],st={key:0,class:"noBut"},nt={class:"childCont"},ct=W({__name:"MenuList",props:{data:{type:Array,default:()=>[]},isChildren:{type:Boolean,default:!1},type:{type:String},defaultData:{type:Array,default:()=>[]}},emits:["changeHandle"],setup(f,{emit:B}){const s=f;q(()=>s.defaultData,o=>{V.value=o||[]},{deep:!0}),q(()=>s.data,o=>{console.log(o,"data")},{deep:!0}),q(()=>s.type,o=>{A.value=o});const A=u(""),m=u([]),i=o=>{m.value=m.value.includes(o.resourceNo)?[]:[o.resourceNo],o.children.length>0&&(y.value=y.value.includes(o.resourceNo)?[]:[o.resourceNo])},y=u([]),S=u([]),V=u([]),$=(o,D)=>{let b=[];b=D.filter(n=>o.findIndex(v=>v===n)===-1),S.value=D.filter(n=>b.includes(n)),B("changeHandle",o,b)},g=(o,D)=>{B("changeHandle",o,D)};return(o,D)=>{const b=C("t-icon"),n=C("t-checkbox"),v=C("t-checkbox-group"),L=C("MenuList",!0);return E(),H("div",at,[(E(!0),H(G,null,ae(f.data.filter(a=>a.resourceType==="m"||a.resourceType==="c"),a=>(E(),H("div",{key:a.resourceNo,class:"menuContContent"},[l(v,{modelValue:V.value,"onUpdate:modelValue":D[0]||(D[0]=_=>V.value=_),onChange:_=>$(_,[a.resourceNo])},{default:r(()=>[e("div",ut,[e("div",{class:"icon",onClick:_=>i(a)},[l(b,{name:"chevron-right-circle",class:z({open:m.value.includes(a.resourceNo)})},null,8,["class"])],8,lt),e("div",{class:z(["fx-1",{pt:a.children.length>0}]),onClick:_=>i(a)},[e("div",null,U(a.resourceName),1),w(e("div",{class:z(["cont",a.children.length>3?"active":""])},[p(" {{ getCheckList(item) }} "),l(v,{value:V.value,onChange:_=>$(_,a.children.filter(M=>M.resourceType==="r").map(M=>M.resourceNo))},{default:r(()=>[p(` <t-checkbox\r
                  v-if="item.children.some((n) => n.resourceType === 'r')"\r
                  key="all"\r
                  :check-all="true"\r
                  label="\u5168\u9009"\r
                  :disabled="!pageType"\r
                /> `),(E(!0),H(G,null,ae(a.children.filter(_=>_.resourceType==="r"),_=>(E(),de(n,{key:_.resourceNo,value:_.resourceNo,disabled:!A.value},{default:r(()=>[I(U(_.resourceName),1)]),_:2},1032,["value","disabled"]))),128)),a.children.every(_=>_.resourceType!=="r")?(E(),H("span",st," \u6682\u65E0\u6309\u94AE\uFF01 ")):p("v-if",!0)]),_:2},1032,["value","onChange"])],2),[[j,m.value.includes(a.resourceNo)]])],10,ot),e("div",null,[l(n,{disabled:!A.value,value:String(a.resourceNo)},null,8,["disabled","value"])])])]),_:2},1032,["modelValue","onChange"]),w(e("div",nt,[l(L,{isChildren:!0,type:f.type,data:a.children,defaultData:f.defaultData,onChangeHandle:g},null,8,["type","data","defaultData"])],512),[[j,y.value.includes(a.resourceNo)]])]))),128))])}}});var dt=X(ct,[["__scopeId","data-v-d692a52e"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/role/components/MenuList.vue"]]);const se=f=>(ue("data-v-0b303de5"),f=f(),le(),f),rt={class:"roleAdmin min-h fx"},it={class:"permissionCont pd-box"},vt={class:"head fx fx-sb"},_t={class:"btnContent"},pt=se(()=>e("span",null,"\u53D6\u6D88",-1)),ft=[pt],ht={class:"dataPmCont fx"},mt=se(()=>e("div",{class:"title"},"\u6570\u636E\u8303\u56F4\uFF1A",-1)),Dt={class:"dataPmTree fx"},gt=se(()=>e("div",{class:"label"},"\u7EC4\u7EC7\uFF1A",-1)),bt=W({__name:"index",setup(f){ce(()=>{V(),b()});const B=u(null),s=u(""),A=u([]),m=u("1"),i=u(!1),y=u([]),S=u([]),V=async()=>{i.value=!0,Ce().then(t=>{i.value=!1,t.code===200?(y.value=D(t.data),S.value=t.data,console.log(y.value,"MenulistData.value")):N.error(t.msg)}).catch(()=>{i.value=!1})},$=t=>{console.log(s.value,t,"---"),s.value==="edit"&&(v.checkedResourceNos=g.value.checkedResourceNos||[],a.dataScope=g.value.dataScope,a.checkedDeptNos=g.value.checkedDeptNos||[]),s.value=""},g=u(),o=t=>{s.value="",v.id=t.id,v.checkedResourceNos=t.checkedResourceNos||[],g.value=t,a.id=t.id,a.dataScope=t.dataScope,a.checkedDeptNos=t.checkedDeptNos||[]},D=t=>{const h=[],k={};for(const c of t)k[c.resourceNo]={...c,children:[]};for(const c of t){const{resourceNo:O,parentResourceNo:F}=c,T=k[O];F===1e14||F==="100000000000000"?h.push(T):(k[F]||(k[F]={children:[]}),c.dataState==="0"&&k[F].children.push({...T,btnList:T.children.filter(R=>R.resourceType==="r").map(R=>R.resourceNo)}))}return h[0].children},b=async()=>{const t=await ye({});t&&t.code===200&&(A.value=n(t.data.items))},n=t=>{let h=[];return h=t?t.map(k=>({value:k.id,label:k.label,children:n(k.children)})):[],h},v=te({id:NaN,checkedResourceNos:[]}),L=(t,h)=>{console.log(v.checkedResourceNos,"-------"),v.checkedResourceNos=[...t,...v.checkedResourceNos],h!=null&&h.length&&(v.checkedResourceNos=v.checkedResourceNos.filter(k=>h.findIndex(c=>c===k)===-1)),v.checkedResourceNos=[...new Set(v.checkedResourceNos)]},a=te({id:NaN,dataScope:"",checkedDeptNos:[]}),_=t=>{a.dataScope=t},M=()=>{s.value="",v.checkedResourceNos=g.value.checkedResourceNos,a.dataScope=g.value.dataScope,a.checkedDeptNos=g.value.checkedDeptNos||[]},J=async()=>{if(!s.value){s.value="edit";return}m.value==="1"?ne(v).then(t=>{t.code===200&&(N.success(t.msg),s.value="",B.value.fetchData())}).catch(()=>{N.error("\u6570\u636E\u63D0\u4EA4\u51FA\u9519\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458")}):ne(a).then(t=>{t.code===200&&(N.success(t.msg),s.value="",B.value.fetchData())}).catch(()=>{N.error("\u6570\u636E\u63D0\u4EA4\u51FA\u9519\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458")})};return(t,h)=>{const k=C("t-radio-button"),c=C("t-radio-group"),O=C("t-space"),F=C("t-radio"),T=C("t-tree");return E(),H("div",rt,[p(" \u89D2\u8272\u5217\u8868\u6A21\u5757 - start "),l(tt,{ref_key:"childRole",ref:B,onClickRow:o},null,512),p(" \u89D2\u8272\u5217\u8868\u6A21\u5757 - end "),p(" \u89D2\u8272\u5BF9\u5E94\u7684\u6743\u9650\u6A21\u5757 - start "),e("div",it,[e("div",vt,[l(O,{direction:"vertical"},{default:r(()=>[l(c,{modelValue:m.value,"onUpdate:modelValue":h[0]||(h[0]=R=>m.value=R),variant:"default-filled","default-value":"1",onChange:$},{default:r(()=>[l(k,{value:"1"},{default:r(()=>[I("\u83DC\u5355\u6743\u9650")]),_:1}),l(k,{value:"2"},{default:r(()=>[I("\u6570\u636E\u6743\u9650")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e("div",_t,[w(e("button",{theme:"primary",type:"submit",class:"bt-grey wt-60",onClick:M},ft,512),[[j,s.value==="edit"]]),e("div",{class:"bt",onClick:J},U(s.value?"\u4FDD\u5B58":"\u7F16\u8F91"),1)])]),p(" \u83DC\u5355\u6743\u9650 - start "),w(e("div",null,[l(dt,{data:y.value,defaultData:v.checkedResourceNos,type:s.value,onChangeHandle:L},null,8,["data","defaultData","type"])],512),[[j,m.value==="1"]]),p(" \u83DC\u5355\u6743\u9650 - end "),p(" \u6570\u636E\u6743\u9650 - start "),w(e("div",null,[e("div",ht,[mt,l(c,{modelValue:a.dataScope,"onUpdate:modelValue":h[1]||(h[1]=R=>a.dataScope=R),"default-value":"1",disabled:!s.value,onChange:_},{default:r(()=>[l(F,{value:"4"},{default:r(()=>[I("\u5168\u90E8")]),_:1}),l(F,{value:"3"},{default:r(()=>[I("\u672C\u7EA7\u53CA\u5B50\u7EA7")]),_:1}),l(F,{value:"2"},{default:r(()=>[I("\u672C\u7EA7")]),_:1}),l(F,{value:"1"},{default:r(()=>[I("\u4E2A\u4EBA")]),_:1}),l(F,{value:"0"},{default:r(()=>[I("\u81EA\u5B9A\u4E49")]),_:1})]),_:1},8,["modelValue","disabled"])]),w(e("div",Dt,[gt,l(T,{modelValue:a.checkedDeptNos,"onUpdate:modelValue":h[2]||(h[2]=R=>a.checkedDeptNos=R),data:A.value,"expand-all":"",checkable:"",disabled:!s.value},null,8,["modelValue","data","disabled"])],512),[[j,a.dataScope==="0"]])],512),[[j,m.value==="2"]]),p(" \u6570\u636E\u6743\u9650 - end ")]),p(" \u89D2\u8272\u5BF9\u5E94\u7684\u6743\u9650\u6A21\u5757 - end ")])}}});var Nt=X(bt,[["__scopeId","data-v-0b303de5"],["__file","D:/project/2023/project-zhyl-admin-vue3-java/src/pages/permission/role/index.vue"]]);export{Nt as default};
